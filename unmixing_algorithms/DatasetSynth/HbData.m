%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% https://github.com/multimodalspectroscopy/UCL-NIR-Spectra/?tab=readme-ov-file
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Hb=[450	53.9200
452	42.3200
454	34.0800
456	28.0880
458	23.7280
460	20.5240
462	18.2080
464	16.4800
466	15.2520
468	14.4080
470	13.8280
472	13.4640
474	13.2720
476	13.1880
478	13.2080
480	13.2880
482	13.4120
484	13.6200
486	13.8600
488	14.1520
490	14.5320
492	14.9440
494	15.4440
496	15.9920
498	16.6320
500	17.3200
502	18.1000
504	18.9080
506	19.7920
508	20.6400
510	21.5320
512	22.3720
514	23.2640
516	24.1000
518	24.9960
520	25.9120
522	26.9480
524	28.0440
526	29.2680
528	30.5760
530	32.0400
532	33.6440
534	35.4640
536	37.4200
538	39.6040
540	41.8800
542	44.2400
544	46.4800
546	48.6000
548	50.3600
550	51.8400
552	52.8400
554	53.4000
556	53.4400
558	53.1600
560	52.4400
562	51.5200
564	50.3600
566	49.0000
568	47.4000
570	45.6800
572	43.8400
574	41.9600
576	40.0800
578	38.2560
580	36.5640
582	34.9360
584	33.3320
586	31.6120
588	29.6880
590	27.5000
592	25.0840
594	22.5160
596	19.9040
598	17.3680
600	15.0360
602	12.9680
604	11.2240
606	9.8080
608	8.6760
610	7.7840
612	7.0720
614	6.5080
616	6.0560
618	5.6720
620	5.3440
622	5.0800
624	4.8480
626	4.6520
628	4.4800
630	4.2040
632	4.0880
634	3.9840
636	3.8960
638	3.8120
640	3.7440
642	3.6800
644	3.6280
646	3.5800
648	3.5360
650	3.4920
652	3.4560
654	3.4080
656	3.3440
658	3.3120
660	3.2600
662	3.1960
664	3.1280
666	3.0520
668	2.9720
670	2.8840
672	2.7960
674	2.7080
676	2.6200
678	2.5320
680	2.4480
682	2.3640
684	2.2840
686	2.2040
688	2.1320
690	2.0640
692	2.0000
694	1.9400
696	1.8840
698	1.8360
700	1.7880
702	1.7440
704	1.7040
706	1.6640
708	1.6240
710	1.5880
712	1.5480
714	1.5160
716	1.4800
718	1.4440
720	1.4120
722	1.3840
724	1.3600
726	1.3360
728	1.3200
730	1.3080
732	1.3040
734	1.3080
736	1.3160
738	1.3320
740	1.3560
742	1.3840
744	1.4200
746	1.4640
748	1.5080
750	1.5520
752	1.5960
754	1.6360
756	1.6600
758	1.6680
760	1.6560
762	1.6280
764	1.5840
766	1.5240
768	1.4560
770	1.3880
772	1.3200
774	1.2560
776	1.1960
778	1.1400
780	1.0920
782	1.0480
784	1.0120
786	0.9800
788	0.9520
790	0.9320
792	0.9120
794	0.8920
796	0.8760
798	0.8640
800	0.8600];

HbO2=[450	64.8
452	59.6
454	55.2
456	51.24
458	47.84
460	44.68
462	42
464	39.5
466	37.332
468	35.336
470	33.596
472	31.972
474	30.548
476	29.212
478	28.008
480	26.888
482	25.928
484	25.024
486	24.292
488	23.552
490	22.964
492	22.38
494	21.892
496	21.412
498	21.016
500	20.616
502	20.28
504	19.936
506	19.708
508	19.528
510	19.512
512	19.684
514	20.168
516	20.94
518	22.192
520	23.924
522	26.316
524	29.28
526	32.92
528	37
530	41.4
532	45.68
534	49.6
536	52.88
538	55.6
540	57.28
542	58.08
544	57.36
546	55.32
548	51.96
550	48.04
552	44.08
554	40.68
556	37.928
558	36.06
560	35.068
562	35.076
564	36.168
566	38.456
568	42
570	46.72
572	52.2
574	57.48
576	61.04
578	61.44
580	57.68
582	50.4
584	41.12
586	31.752
588	23.548
590	17.048
592	12.248
594	8.864
596	6.536
598	4.936
600	3.8280
602	3.1000
604	2.5640
606	2.1560
608	1.8400
610	1.5880
612	1.3840
614	1.2200
616	1.0840
618	0.9680
620	0.8720
622	0.7880
624	0.7200
626	0.6560
628	0.6000
630	0.5560
632	0.5160
634	0.4800
636	0.4560
638	0.4320
640	0.4160
642	0.4040
644	0.3960
646	0.3960
648	0.3920
650	0.3920
652	0.3960
654	0.3960
656	0.3920
658	0.3920
660	0.4000
662	0.4040
664	0.4040
666	0.4060
668	0.4080
670	0.4080
672	0.4080
674	0.4120
676	0.4120
678	0.4120
680	0.4120
682	0.4120
684	0.4120
686	0.4120
688	0.4120
690	0.4120
692	0.4120
694	0.4120
696	0.4160
698	0.4160
700	0.4200
702	0.4240
704	0.4240
706	0.4320
708	0.4360
710	0.4400
712	0.4480
714	0.4520
716	0.4600
718	0.4640
720	0.4720
722	0.4800
724	0.4880
726	0.4920
728	0.5000
730	0.5080
732	0.5160
734	0.5240
736	0.5320
738	0.5400
740	0.5480
742	0.5560
744	0.5640
746	0.5720
748	0.5800
750	0.5920
752	0.6000
754	0.6080
756	0.6160
758	0.6280
760	0.6360
762	0.6440
764	0.6520
766	0.6640
768	0.6720
770	0.6840
772	0.6920
774	0.7000
776	0.7120
778	0.7200
780	0.7320
782	0.7400
784	0.7520
786	0.7600
788	0.7720
790	0.7840
792	0.7920
794	0.8040
796	0.8120
798	0.8240
800	0.8320];

HbCO=[450	40.2800
452	37.5160
454	35.2360
456	33.2440
458	31.5880
460	30.1160
462	28.8680
464	27.7320
466	26.7600
468	25.8760
470	25.1000
472	24.3880
474	23.8080
476	23.2640
478	22.8400
480	22.4600
482	22.1680
484	21.8640
486	21.6120
488	21.3560
490	21.1680
492	21.0080
494	20.9400
496	20.9000
498	20.9680
500	21.1160
502	21.3800
504	21.7160
506	22.2480
508	22.8920
510	23.7600
512	24.9000
514	26.3840
516	28.2240
518	30.5360
520	33.1880
522	36.2000
524	39.4000
526	42.7600
528	46.0000
530	49.1600
532	51.9600
534	54.4400
536	56.2000
538	57.2000
540	57.0800
542	56.1600
544	54.3600
546	52.3200
548	50.2000
550	48.4400
552	47.1200
554	46.5200
556	46.6000
558	47.4800
560	49.0000
562	51.2000
564	53.7200
566	56.1600
568	57.7200
570	57.8400
572	55.9600
574	52.2800
576	47.0400
578	40.9600
580	34.5520
582	28.3560
584	22.8400
586	18.2000
588	14.4720
590	11.5640
592	9.3200
594	7.5960
596	6.2680
598	5.2280
600	4.4160
602	3.7560
604	3.2240
606	2.7880
608	2.4280
610	2.1200
612	1.8640
614	1.6880
616	1.5360
618	1.3920
620	1.2640
622	1.1480
624	1.0440
626	0.9520
628	0.8640
630	0.7840
632	0.7160
634	0.6520
636	0.5920
638	0.5440
640	0.5000
642	0.4640
644	0.4320
646	0.4080
648	0.3840
650	0.3640
652	0.3440
654	0.3280
656	0.3080
658	0.2840
660	0.2760
662	0.2640
664	0.2480
666	0.2360
668	0.2240
670	0.2120
672	0.2000
674	0.1880
676	0.1800
678	0.1720
680	0.1640
682	0.1560
684	0.1480
686	0.1440
688	0.1360
690	0.1320
692	0.1280
694	0.1240
696	0.1200
698	0.1160
700	0.1120
702	0.1080
704	0.1080
706	0.1040
708	0.1000
710	0.1000
712	0.1000
714	0.0960
716	0.0960
718	0.0960
720	0.0920
722	0.0920
724	0.0920
726	0.0880
728	0.0880
730	0.0880
732	0.0880
734	0.0840
736	0.0840
738	0.0840
740	0.0840
742	0.0800
744	0.0800
746	0.0800
748	0.0800
750	0.0760
752	0.0760
754	0.0760
756	0.0760
758	0.0760
760	0.0720
762	0.0720
764	0.0720
766	0.0720
768	0.0720
770	0.0720
772	0.0720
774	0.0680
776	0.0680
778	0.0680
780	0.0680
782	0.0680
784	0.0680
786	0.0680
788	0.0640
790	0.0640
792	0.0640
794	0.0640
796	0.0640
798	0.0640
800	0.0600];

HbS=[450	52.9200
452	47.8400
454	43.6000
456	40.3200
458	37.4800
460	35.2000
462	33.0800
464	31.4800
466	30.0400
468	28.8800
470	27.7200
472	26.8800
474	26.1600
476	25.6400
478	25.1200
480	24.8000
482	24.6000
484	24.4800
486	24.4800
488	24.6000
490	24.6800
492	24.8800
494	25.1200
496	25.4000
498	25.7200
500	26.0000
502	26.3600
504	26.6400
506	26.9600
508	27.1200
510	27.2800
512	27.3200
514	27.2400
516	27.0400
518	26.7200
520	26.2400
522	25.6800
524	25.1200
526	24.4400
528	23.8000
530	22.9600
532	22.6000
534	22.2400
536	22.1600
538	22.1600
540	22.4800
542	22.7600
544	23.6000
546	24.3600
548	25.2400
550	26.2800
552	26.9600
554	27.6000
556	27.9200
558	28.0800
560	28.1200
562	28.0000
564	27.8000
566	27.3600
568	26.7600
570	25.7200
572	24.4000
574	23.2000
576	22.4800
578	22.7200
580	23.8000
582	25.6400
584	27.7200
586	29.3200
588	30.3600
590	31.7600
592	32.4800
594	33.4800
596	34.6000
598	35.8800
600	37.4800
602	39.5200
604	42.1600
606	45.6400
608	49.9600
610	55.2400
612	61.1600
614	67.6800
616	74.0800
618	79.7600
620	83.6400
622	84.8400
624	82.9200
626	77.8800
628	70.1600
630	61.1200
632	51.7600
634	42.9200
636	35.2000
638	29.0400
640	24.0800
642	20.2400
644	17.1600
646	14.8400
648	13.0000
650	11.5600
652	10.3600
654	9.4400
656	8.6800
658	8.0800
660	7.5200
662	7.0400
664	6.6400
666	6.2800
668	6.0000
670	5.7200
672	5.4800
674	5.2800
676	5.1200
678	4.9200
680	4.7600
682	4.6400
684	4.4800
686	4.3600
688	4.2800
690	4.1600
692	4.0800
694	4.0000
696	3.9600
698	3.8800
700	3.8400
702	3.8000
704	3.7600
706	3.7200
708	3.7200
710	3.6800
712	3.6400
714	3.6000
716	3.6000
718	3.5600
720	3.5200
722	0.2444
724	0.2417
726	0.2389
728	3.4000
730	3.3600
732	3.3200
734	3.2800
736	3.2400
738	3.2400
740	3.2000
742	3.1600
744	3.1600
746	3.1200
748	3.0800
750	3.0400
752	3.0000
754	2.9600
756	2.9200
758	2.8800
760	2.8400
762	2.7600
764	2.7200
766	2.6800
768	2.6400
770	2.6000
772	2.5600
774	2.4800
776	2.4000
778	2.3600
780	2.2800
782	2.2400
784	2.1600
786	2.0800
788	2.0000
790	1.9600
792	1.8800
794	1.8000
796	1.7200
798	1.6400
800	1.6000];

MetHb=[450.0 37979.16900
455.0 35935.92690
460.0 34103.26420
465.0 32884.82020
470.0 31709.83820
475.0 31075.93790
480.0 31899.79390
485.0 33090.21610
490.0 34617.00980
495.0 35729.77700
500.0 36358.50890
505.0 35729.77700
510.0 34205.10390
515.0 32461.13000
520.0 30592.99160
525.0 28946.51130
530.0 27565.83200
535.0 26349.99310
540.0 24950.72020
545.0 23049.71200
550.0 20651.48440
555.0 18223.08430
560.0 16473.19290
565.0 16015.68300
570.0 15860.84630
575.0 15738.73000
580.0 15738.73000
585.0 15165.59890
590.0 14298.91300
595.0 13341.91840
600.0 12878.00200
605.0 12766.16900
610.0 12766.16900
615.0 12990.81390
620.0 13908.88740
625.0 14806.57300
630.0 15355.28040
635.0 15153.85820
640.0 13803.87760
645.0 10872.88490
650.0 7824.77667
655.0 5281.40319
660.0 3706.64876
665.0 2645.23461
670.0 1903.16662
675.0 1415.80821
680.0 1203.42206
685.0 1025.49677
690.0 940.773010
695.0 902.233430
700.0 877.368060];

figure;
plot(HbCO(:,1),HbCO(:,2),'LineWidth',2); hold on;
plot(HbS(:,1),HbS(:,2),'LineWidth',2);
plot(MetHb(:,1),MetHb(:,2),'LineWidth',2)
load('EMHbHbO2_3.mat')

w=wave2(wave2>450 & wave2<700);
Hbu=interp1(Hb(:,1),Hb(:,2),w);
HbO2u=interp1(HbO2(:,1),HbO2(:,2),w);
HbCOu=interp1(HbCO(:,1),HbCO(:,2),w);
HbSu=interp1(HbS(:,1),HbS(:,2),w);
MetHbu=interp1(MetHb(:,1),MetHb(:,2),w);

plot(w,HbCOu,'+');
plot(w,HbSu,'+');
plot(w,MetHbu,'+');
PP3=[Hbu' HbO2u' HbCOu' HbSu' MetHbu'];
PP3=PP3./sum(PP3,1);
figure;
plot(w',PP3,'LineWidth',2);
xlabel('wavelength (nm)');
ylabel('normalized intensity');
grid on;
legend('Hb','HbO2', 'HbCO', 'HbS','MetHb');

